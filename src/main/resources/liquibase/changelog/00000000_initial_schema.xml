<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">
  <changeSet id="1" author="harut.tarzyan">
    <createTable tableName="molecular_metadata">
      <column name="id" type="UUID" defaultValueComputed="gen_random_uuid()">
        <constraints primaryKey="true" nullable="false"/>
      </column>
      <column name="bg_id" type="varchar(10)">
        <constraints nullable="false"/>
      </column>
      <column name="report_type" type="varchar(20)">
        <constraints nullable="false"/>
      </column>
      <column name="lab_name" type="varchar(255)">
        <constraints nullable="true"/>
      </column>
      <column name="lab_test_name" type="varchar(255)">
        <constraints nullable="true"/>
      </column>
      <column name="same_sample_origin" type="varchar(10)">
        <constraints nullable="false"/>
      </column>
      <column name="other_sample_origin" type="varchar(40)">
        <constraints nullable="true"/>
      </column>
      <column name="biopsy_origin_location" type="varchar(255)">
        <constraints nullable="true"/>
      </column>
      <column name="specimen_and_block_id" type="varchar(255)">
        <constraints nullable="true"/>
      </column>
      <column name="collection_date" type="date">
        <constraints nullable="true"/>
      </column>
      <column name="data_source" type="varchar(255)">
        <constraints nullable="true"/>
      </column>
      <column name="scan_issues" type="boolean">
        <constraints nullable="true"/>
      </column>
      <column name="comment" type="text">
        <constraints nullable="true"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet id="2" author="harut.tarzyan">
    <createTable tableName="molecular_data_method_common_parameter">
      <column name="id" type="UUID" defaultValueComputed="gen_random_uuid()">
        <constraints primaryKey="true" nullable="false"/>
      </column>
      <column name="method_name" type="varchar(50)">
        <constraints nullable="false"/>
      </column>
      <column name="method_event" type="varchar(40)">
        <constraints nullable="true"/>
      </column>
      <column name="method_type" type="varchar(60)">
        <constraints nullable="false"/>
      </column>
      <column name="metadata_id" type="UUID">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet id="3" author="harut.tarzyan">
    <createTable tableName="molecular_data_method_extended_parameter">
      <column name="id" type="UUID" defaultValueComputed="gen_random_uuid()">
        <constraints primaryKey="true" nullable="false"/>
      </column>
      <column name="parameter_name" type="varchar(255)">
        <constraints nullable="true"/>
      </column>
      <column name="parameter_value" type="varchar(255)">
        <constraints nullable="true"/>
      </column>
      <column name="value_type" type="varchar(255)">
        <constraints nullable="true"/>
      </column>
      <column name="method_id" type="UUID">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet id="4" author="harut.tarzyan">
    <addForeignKeyConstraint baseTableName="molecular_data_method_common_parameter"
                             baseColumnNames="metadata_id"
                             referencedTableName="molecular_metadata"
                             referencedColumnNames="id"
                             onDelete="CASCADE"
                             constraintName="fk_molecular_data_method_common_parameter_molecular_metadata"/>
  </changeSet>
  <changeSet id="5" author="harut.tarzyan">
    <addForeignKeyConstraint baseTableName="molecular_data_method_extended_parameter"
                             baseColumnNames="method_id"
                             referencedTableName="molecular_data_method_common_parameter"
                             referencedColumnNames="id"
                             onDelete="CASCADE"
                             constraintName="fk_molecular_data_method_extended_parameter_molecular_data_method_common_parameter"/>
  </changeSet>
</databaseChangeLog>